{% extends "core/base.html" %}

{% block content %}

<h2 class="mb-4">âœï¸ ç¼–è¾‘ AI Prompt é…ç½®</h2>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    {% endfor %}
{% endif %}

<form method="post">
    {% csrf_token %}
    
    <div class="card mb-4">
        <div class="card-header" style="background-color: #f8f9fa;">
            <h5 class="mb-0">ç³»ç»Ÿæç¤ºè¯ï¼ˆSystem Promptï¼‰</h5>
            <small class="text-muted">è¿™æ˜¯å‘é€ç»™AIçš„ç³»ç»Ÿçº§æç¤ºï¼Œç”¨äºå®šä¹‰AIçš„è§’è‰²å’Œè¡Œä¸º</small>
        </div>
        <div class="card-body">
            <textarea name="system_prompt" class="form-control" rows="3" required>{{ prompt_config.system_prompt }}</textarea>
        </div>
    </div>
    
    <div class="card mb-4">
        <div class="card-header" style="background-color: #f8f9fa;">
            <h5 class="mb-0">æ•°æ®åº“è¡¨ç»“æ„è¯´æ˜</h5>
            <small class="text-muted">æè¿°æ•°æ®åº“è¡¨ç»“æ„ï¼Œå¸®åŠ©AIç†è§£æ•°æ®åº“æ¶æ„</small>
        </div>
        <div class="card-body">
            <textarea name="table_schema" class="form-control" rows="20" required>{{ prompt_config.table_schema }}</textarea>
        </div>
    </div>
    
    <div class="card mb-4">
        <div class="card-header" style="background-color: #f8f9fa;">
            <h5 class="mb-0">ç”¨æˆ·æç¤ºè¯æ¨¡æ¿</h5>
            <small class="text-muted">
                ç”¨æˆ·æç¤ºè¯æ¨¡æ¿ã€‚ä½¿ç”¨ <code>{table_schema}</code> å’Œ <code>{question}</code> ä½œä¸ºå ä½ç¬¦ï¼Œå®ƒä»¬ä¼šè¢«å®é™…å†…å®¹æ›¿æ¢ã€‚
            </small>
        </div>
        <div class="card-body">
            <textarea name="user_prompt_template" class="form-control" rows="15" required>{{ prompt_config.user_prompt_template }}</textarea>
        </div>
    </div>
    
    <div class="alert alert-info">
        <strong>ğŸ’¡ æç¤ºï¼š</strong>
        <ul class="mb-0">
            <li>ä¿®æ”¹åï¼Œæ‰€æœ‰æ–°çš„AIæŸ¥è¯¢éƒ½ä¼šä½¿ç”¨æ–°çš„prompté…ç½®</li>
            <li>å»ºè®®åœ¨ä¿®æ”¹å‰å…ˆæŸ¥çœ‹å½“å‰çš„prompté…ç½®</li>
            <li>ç¡®ä¿æ¨¡æ¿ä¸­åŒ…å« <code>{table_schema}</code> å’Œ <code>{question}</code> å ä½ç¬¦</li>
        </ul>
    </div>
    
    <div class="d-flex gap-2">
        <button type="submit" class="btn btn-primary">
            <i class="fa fa-save"></i> ä¿å­˜é…ç½®
        </button>
        <a href="{% url 'view_prompt' %}" class="btn btn-secondary">
            <i class="fa fa-eye"></i> æŸ¥çœ‹å½“å‰é…ç½®
        </a>
        <a href="{% url 'smart_query' %}" class="btn btn-outline-secondary">
            <i class="fa fa-arrow-left"></i> è¿”å›æ™ºèƒ½æŸ¥è¯¢
        </a>
    </div>
</form>

{% endblock %}

