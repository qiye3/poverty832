{% extends "core/base.html" %}

{% block content %}

<h2 class="mb-4">ğŸ“Š æ•°æ®åº“è¯¦æƒ…</h2>

<p class="text-muted mb-4">
    æ­¤é¡µé¢æ˜¾ç¤ºæ‰€æœ‰æ•°æ®è¡¨çš„çœŸå®è¡¨åï¼ˆå¯åœ¨SQLä¸­ç›´æ¥ä½¿ç”¨ï¼‰å’Œåˆ—åä¿¡æ¯ã€‚
</p>

{% for table in tables_info %}
<div class="card mb-4 shadow-sm">
    <div class="card-header" style="background-color: #f8f9fa; border-bottom: 2px solid #dee2e6;">
        <h5 class="mb-0" style="color: #495057;">
            <i class="fa fa-table text-secondary"></i> {{ table.display_name }}
        </h5>
    </div>
    <div class="card-body">
        <div class="row mb-3">
            <div class="col-md-6">
                <strong>æ¨¡å‹åç§°ï¼š</strong>{{ table.model_name }}
            </div>
            <div class="col-md-6">
                <strong>æ•°æ®åº“è¡¨åï¼š</strong>
                <code class="bg-light px-2 py-1 rounded">{{ table.table_name }}</code>
            </div>
        </div>
        
        <h6 class="mt-3 mb-3" style="color: #6c757d;">å­—æ®µä¿¡æ¯</h6>
        <div class="table-responsive">
            <table class="table table-bordered" style="border-color: #e9ecef;">
                <thead style="background-color: #f8f9fa;">
                    <tr>
                        <th>æ¨¡å‹å­—æ®µå</th>
                        <th>æ•°æ®åº“åˆ—å</th>
                        <th>æ•°æ®ç±»å‹</th>
                        <th>ä¸»é”®</th>
                        <th>å…è®¸NULL</th>
                        <th>å…è®¸ç©ºç™½</th>
                    </tr>
                </thead>
                <tbody>
                    {% for field in table.fields %}
                    <tr>
                        <td style="background-color: #fafafa;">
                            <code style="color: #495057; background-color: #e9ecef; padding: 2px 6px; border-radius: 3px;">{{ field.name }}</code>
                            {% if field.primary_key %}
                                <span class="badge ms-1" style="background-color: #dc3545; opacity: 0.8;">PK</span>
                            {% endif %}
                        </td>
                        <td>
                            <code style="color: #0d6efd; background-color: #e7f1ff; padding: 2px 6px; border-radius: 3px;">{{ field.db_column }}</code>
                            {% if field.related_table %}
                                <br><small class="text-muted">â†’ {{ field.related_table }}</small>
                            {% endif %}
                        </td>
                        <td>
                            <span class="badge" style="background-color: #17a2b8; opacity: 0.85;">{{ field.type }}</span>
                        </td>
                        <td>
                            {% if field.primary_key %}
                                <span class="badge" style="background-color: #28a745; opacity: 0.85;">æ˜¯</span>
                            {% else %}
                                <span class="text-muted">å¦</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if field.null %}
                                <span class="badge" style="background-color: #ffc107; color: #856404; opacity: 0.9;">æ˜¯</span>
                            {% else %}
                                <span class="text-muted">å¦</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if field.blank %}
                                <span class="badge" style="background-color: #6c757d; opacity: 0.8;">æ˜¯</span>
                            {% else %}
                                <span class="text-muted">å¦</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div class="mt-3">
            <h6 style="color: #6c757d;">SQL æŸ¥è¯¢ç¤ºä¾‹</h6>
            <div style="background-color: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 3px solid #0d6efd;">
                <code style="color: #495057;">
                    SELECT * FROM {{ table.table_name }} LIMIT 10;
                </code>
            </div>
        </div>
    </div>
</div>
{% endfor %}

<div class="card shadow-sm">
    <div class="card-header" style="background-color: #e7f3ff; border-bottom: 2px solid #b3d9ff;">
        <h5 class="mb-0" style="color: #004085;">ğŸ’¡ ä½¿ç”¨æç¤º</h5>
    </div>
    <div class="card-body" style="background-color: #f8f9fa;">
        <ul style="color: #495057;">
            <li class="mb-2"><strong>æ•°æ®åº“è¡¨å</strong>ï¼šåœ¨SQLæŸ¥è¯¢ä¸­ç›´æ¥ä½¿ç”¨æ­¤åç§°ï¼Œä¾‹å¦‚ï¼š<code style="background-color: #e9ecef; padding: 2px 6px; border-radius: 3px;">SELECT * FROM {{ tables_info.0.table_name }};</code></li>
            <li class="mb-2"><strong>æ•°æ®åº“åˆ—å</strong>ï¼šåœ¨SQLæŸ¥è¯¢ä¸­ä½¿ç”¨æ­¤åç§°æ¥å¼•ç”¨å­—æ®µï¼Œä¾‹å¦‚ï¼š<code style="background-color: #e9ecef; padding: 2px 6px; border-radius: 3px;">SELECT {{ tables_info.0.fields.0.db_column }} FROM {{ tables_info.0.table_name }};</code></li>
            <li class="mb-2"><strong>æ¨¡å‹å­—æ®µå</strong>ï¼šåœ¨Django ORMä¸­ä½¿ç”¨æ­¤åç§°ï¼Œä¾‹å¦‚ï¼š<code style="background-color: #e9ecef; padding: 2px 6px; border-radius: 3px;">County.objects.filter(name="...")</code></li>
            <li>å¦‚æœå­—æ®µåå’Œåˆ—åç›¸åŒï¼Œè¯´æ˜æ²¡æœ‰è‡ªå®šä¹‰åˆ—åï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å­—æ®µå</li>
        </ul>
    </div>
</div>

{% endblock %}

