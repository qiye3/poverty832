```sql
-- 创建数据库
CREATE DATABASE poverty832_tracking;
USE poverty832_tracking;

-- 1. County 表
CREATE TABLE County (
    county_id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    province VARCHAR(50) NOT NULL,
    UNIQUE(name, province)
);


-- 2. InfrastructureService 表
CREATE TABLE InfrastructureService (
    infra_id INT PRIMARY KEY AUTO_INCREMENT,
    county_id INT NOT NULL,
    year YEAR NOT NULL,
    pct_village_with_hard_road DECIMAL(5,2),
    pct_village_with_electricity DECIMAL(5,2),
    broadband_coverage DECIMAL(5,2),
    water_supply_coverage DECIMAL(5,2),
    sanitation_coverage DECIMAL(5,2),
    FOREIGN KEY (county_id) REFERENCES County(county_id)
);

-- 3. AgricultureSales 表
CREATE TABLE AgricultureSales (
    sale_id INT PRIMARY KEY AUTO_INCREMENT,
    county_id INT NOT NULL,
    year YEAR NOT NULL,
    product_type VARCHAR(100),
    sales_volume DECIMAL(18,2),
    sales_value DECIMAL(18,2),
    FOREIGN KEY (county_id) REFERENCES County(county_id)
);


-- 4. CountyEconomy（县域经济发展）
CREATE TABLE CountyEconomy (
    econ_id INT PRIMARY KEY AUTO_INCREMENT,
    county_id INT NOT NULL,
    year YEAR NOT NULL,
    
    gdp_total DECIMAL(18,2) COMMENT '年GDP (亿元)',
    fiscal_revenue DECIMAL(18,2) COMMENT '财政收入 (亿元)',
    per_capita_income DECIMAL(18,2) COMMENT '全体居民人均可支配收入 (元)',
    
    FOREIGN KEY (county_id) REFERENCES County(county_id),
    UNIQUE KEY uk_county_year (county_id, year) 
);

-- 5. CountyDemographics（人口与就业）
CREATE TABLE CountyDemographics (
    demo_id INT PRIMARY KEY AUTO_INCREMENT,
    county_id INT NOT NULL,
    year YEAR NOT NULL,
    population_total BIGINT,      
    urbanization_rate DECIMAL(5,2), 
    unemployment_rate DECIMAL(5,2), 
    migrant_workers BIGINT,        
    social_security_rate DECIMAL(5,2), 
    FOREIGN KEY (county_id) REFERENCES County(county_id)
);

-- 创建用户角色

CREATE USER 'admin'@'localhost' IDENTIFIED BY 'admin_pass';
CREATE USER 'data_entry'@'localhost' IDENTIFIED BY 'dataentry_pass';
CREATE USER 'analyst'@'localhost' IDENTIFIED BY 'analyst_pass';

-- 授权

-- admin: 所有权限
GRANT ALL PRIVILEGES ON poverty832_tracking.* TO 'admin'@'localhost';

-- data_entry: 插入 / 更新 / 查询
GRANT SELECT, INSERT, UPDATE ON poverty832_tracking.* TO 'data_entry'@'localhost';

-- analyst: 只读
GRANT SELECT ON poverty832_tracking.* TO 'analyst'@'localhost';

FLUSH PRIVILEGES;
```

